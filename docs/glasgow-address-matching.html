<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 Glasgow Address Matching | Companies House Data Quality</title>
<meta name="author" content="Rob Eva and Lauren Calow">
<meta name="description" content="5.1 Introduction and Purpose As part of Companies House Data Strategy, Data Governance and Data Quality is being reviewed. From this, one of the issues identified with Companies House data, is...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="Chapter 5 Glasgow Address Matching | Companies House Data Quality">
<meta property="og:type" content="book">
<meta property="og:url" content="https://companieshouse.github.io/DARr/glasgow-address-matching.html">
<meta property="og:image" content="https://companieshouse.github.io/DARr/../images/star2.png">
<meta property="og:description" content="5.1 Introduction and Purpose As part of Companies House Data Strategy, Data Governance and Data Quality is being reviewed. From this, one of the issues identified with Companies House data, is...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 5 Glasgow Address Matching | Companies House Data Quality">
<meta name="twitter:description" content="5.1 Introduction and Purpose As part of Companies House Data Strategy, Data Governance and Data Quality is being reviewed. From this, one of the issues identified with Companies House data, is...">
<meta name="twitter:image" content="https://companieshouse.github.io/DARr/../images/star2.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Companies House Data Quality</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="data-quality-principles.html"><span class="header-section-number">2</span> Data Quality Principles</a></li>
<li><a class="" href="reproducible-analytical-pipeline-rap.html"><span class="header-section-number">3</span> Reproducible Analytical Pipeline (RAP)</a></li>
<li><a class="" href="birmingham-address-matching.html"><span class="header-section-number">4</span> Birmingham Address Matching</a></li>
<li><a class="active" href="glasgow-address-matching.html"><span class="header-section-number">5</span> Glasgow Address Matching</a></li>
<li><a class="" href="application-programming-interface-api.html"><span class="header-section-number">6</span> Application Programming Interface (API)</a></li>
<li><a class="" href="appendix.html">Appendix</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/companieshouse/DARr">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="glasgow-address-matching" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Glasgow Address Matching<a class="anchor" aria-label="anchor" href="#glasgow-address-matching"><i class="fas fa-link"></i></a>
</h1>
<div id="introduction-and-purpose-1" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Introduction and Purpose<a class="anchor" aria-label="anchor" href="#introduction-and-purpose-1"><i class="fas fa-link"></i></a>
</h2>
<p>As part of Companies House Data Strategy, Data Governance and Data Quality is being reviewed. From this, one of the issues identified with Companies House data, is that around 1% of companies do not supply an accurate postcode, or do not provide a postcode at all.</p>
<p>The current legislation is that Companies have to provide a physical address, however it is not a legal requirement to provide a postcode.</p>
<p>Companies House also states the below regarding the information available for public use:
“We carry out basic checks on documents received to make sure that they have been fully completed and signed, but we do not have the statutory power or capability to verify the accuracy of the information that companies send to us.”</p>
<p>This means some data can be incorrectly input and isn’t verified, leading to a lower data quality, particularly when some fields on the registering form are not mandatory.
In order to gain further insight on the postcode inaccuracies in Companies House data, a scoring matrix for the quality of address and postcode data given by a company. Companies address details were compared to the Postcode Address File (PAF) and scores given when the address details met a certain criteria.</p>
</div>
<div id="scores-used-1" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Scores used<a class="anchor" aria-label="anchor" href="#scores-used-1"><i class="fas fa-link"></i></a>
</h2>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:unnamed-chunk-1">Table 4.1: </span>Postcode Scoring Matrix | Version 1</caption>
<thead><tr class="header">
<th align="right">Score</th>
<th align="left">Definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="left">No postcode given</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Postcode given but doesn’t exist in PAF</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">Partial postcode given</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">Postcode matches PAF but given in the incorrect field</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">Full correct postcode given, address doesn’t match PAF</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">Full correct postcode given, address partially matches PAF</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="left">Address and postcode details match PAF</td>
</tr>
</tbody>
</table></div>
</div>
<div id="data-1" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Data<a class="anchor" aria-label="anchor" href="#data-1"><i class="fas fa-link"></i></a>
</h2>
<div id="companies-house-data-1" class="section level3" number="5.3.1">
<h3>
<span class="header-section-number">5.3.1</span> Companies House Data<a class="anchor" aria-label="anchor" href="#companies-house-data-1"><i class="fas fa-link"></i></a>
</h3>
<p>The data from Companies House was from the Companies House Free Company Data Product containing basic details of live companies on the register.</p>
<p>This is saved on the Companies House website. The file used for this data set was named ‘BasicCompanyDataAsOneFile-2022-03-01.zip (415Mb)’ and is publicly available at:</p>
<p><a href="http://download.companieshouse.gov.uk/en_output.html" class="uri">http://download.companieshouse.gov.uk/en_output.html</a></p>
</div>
<div id="postcode-address-file-1" class="section level3" number="5.3.2">
<h3>
<span class="header-section-number">5.3.2</span> Postcode Address File<a class="anchor" aria-label="anchor" href="#postcode-address-file-1"><i class="fas fa-link"></i></a>
</h3>
<p>The PAF is a database containing all known postcodes in the UK, containing the Royal Mail postal addressed. This was downloaded from MongoDB.</p>
<p>The data used in this analysis containing the Glasgow addresses is saved in the below Companies House sharepoint page (access may be restricted to DAR).</p>
<p><a href="https://companieshouse.sharepoint.com/sites/team-aci/Shared%20Documents/Forms/AllItems.aspx?id=%2Fsites%2Fteam%2Daci%2FShared%20Documents%2FData%20Quality%2FPostcode%20Files%2FGLASGOW&amp;p=true" class="uri">https://companieshouse.sharepoint.com/sites/team-aci/Shared%20Documents/Forms/AllItems.aspx?id=%2Fsites%2Fteam%2Daci%2FShared%20Documents%2FData%20Quality%2FPostcode%20Files%2FGLASGOW&amp;p=true</a></p>
</div>
</div>
<div id="software-1" class="section level2" number="5.4">
<h2>
<span class="header-section-number">5.4</span> Software<a class="anchor" aria-label="anchor" href="#software-1"><i class="fas fa-link"></i></a>
</h2>
<p>The Software/programs used for analysis were Microsoft Excel and Microsoft Power BI.</p>
</div>
<div id="caveats-and-limitations-1" class="section level2" number="5.5">
<h2>
<span class="header-section-number">5.5</span> Caveats and Limitations<a class="anchor" aria-label="anchor" href="#caveats-and-limitations-1"><i class="fas fa-link"></i></a>
</h2>
<p>This data was the current position of Companies House and the PAF on 11/03/2022 therefore any subsequent updates in the Companies House data or Postcode Address File will not be reflected in this analysis.</p>
<p>The filters used within the data were:</p>
<ul>
<li>Postcodes beginning with G1 - G7</li>
<li>‘Glasgow’ filled in the address line 2</li>
<li>‘Glasgow’ in the post town.</li>
</ul>
<p>Not all address data was complete so the filters were applied to fit one or more of the above criteria.</p>
</div>
<div id="method-1" class="section level2" number="5.6">
<h2>
<span class="header-section-number">5.6</span> Method<a class="anchor" aria-label="anchor" href="#method-1"><i class="fas fa-link"></i></a>
</h2>
<p>Import the data files onto Power BI (desktop).</p>
<div id="cleaning-the-data-1" class="section level3" number="5.6.1">
<h3>
<span class="header-section-number">5.6.1</span> Cleaning the data<a class="anchor" aria-label="anchor" href="#cleaning-the-data-1"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Open the PAF and highlight the ‘postcode.stripped’ column. Replace the spaces with nothing to remove any whitespace.</p></li>
<li><p>Open the CH data file and highlight the ‘RegAddress.PostCode’ column. Replace the spaces with nothing to remove any whitespace.</p></li>
</ol>
</div>
<div id="separating-the-glasgow-data" class="section level3" number="5.6.2">
<h3>
<span class="header-section-number">5.6.2</span> Separating the Glasgow data<a class="anchor" aria-label="anchor" href="#separating-the-glasgow-data"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Open the Companies House Data in the Query editor</p></li>
<li>
<p>Add a conditional column and insert the below conditions to populate the condition with the phrase “GLASGOW,” else “Other.”</p>
<ul>
<li>‘RegAddress.PostCode’ beings with ‘G1,’’G2’,’G3’,’G4’,’G5’,’G6’,’G7’ OR</li>
<li>RegAddress.AddressLine1, RegAddress. AddressLine2, RegAddress.PostTown, RegAddress.County contains ‘Glasgow.’</li>
</ul>
</li>
<li><p>Filter any remaining rows out (in this data, there were a few locations on ‘Glasgow Road’ with a different postcode that were not filtered out using the above conditions and some postcodes beginning with be such as B80 which are not in the Glasgow PAF).</p></li>
<li><p>Use a filter to only select the values in this column that say ‘Glasgow.’</p></li>
<li><p>Close and apply the query.</p></li>
</ol>
</div>
</div>
<div id="scoring-the-data-1" class="section level2" number="5.7">
<h2>
<span class="header-section-number">5.7</span> Scoring the data<a class="anchor" aria-label="anchor" href="#scoring-the-data-1"><i class="fas fa-link"></i></a>
</h2>
<div id="score-0---no-postcode-given-1" class="section level3" number="5.7.1">
<h3>
<span class="header-section-number">5.7.1</span> Score 0 - No Postcode Given<a class="anchor" aria-label="anchor" href="#score-0---no-postcode-given-1"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Add a new column on the CH File. This can be done in the query editor, or ‘Data’ view. For this report, the column was added in the ‘Data’ view.</li>
<li>Input the formula No Postcode = if(‘BasicCompanyDataAsOneFile-2022-03-01’[RegAddress.PostCode]=““,0,1)</li>
<li>into the new column. It will return a 0 for the postcodes in the postcode field that are blank, and a 1 for the rows in the postcode field which contain a value.</li>
<li>Go to the reports tab and into the ‘Score 0’ sheet.</li>
<li>Click onto a visualisation to insert. A pie chart was used for the Glasgow file as there were only two distinct values. The legend and details are the column that contains the “0” or “1.” Values are the count of this field. A table summarizing these values was also added to the sheet.</li>
</ol>
</div>
<div id="score-1---postcode-given-but-doesnt-exist-in-paf-1" class="section level3" number="5.7.2">
<h3>
<span class="header-section-number">5.7.2</span> Score 1 - Postcode given but doesn’t exist in PAF<a class="anchor" aria-label="anchor" href="#score-1---postcode-given-but-doesnt-exist-in-paf-1"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Add a new column on the CH File. This can be done in the query editor, or ‘Data’ view. For this report, the column was added in the ‘Data’ view.</li>
<li>Input the formula PAF Match = CONTAINS(‘G-2022-03,’‘G-2022-03’[postcode.stripped],‘BasicCompanyDataAsOneFile-2022-03-01’[RegAddress.PostCode]) into the new column. It will return a True for the postcodes in the postcode field that match the PAF and a False for the postcodes that do not match the PAF. The column was labelled ‘PAF Match.’</li>
<li>Insert another new column and input the formula Length = LEN(‘BasicCompanyDataAsOneFile-2022-03-01’[RegAddress.PostCode])</li>
<li>This will count the number of characters in the postcode supplied in the CH file. The column was labelled ‘Postcode Length.’</li>
<li>Go to the reports tab and into the ‘Score 1’ sheet.</li>
<li>Click onto a visualisation to insert. A pie chart was used for the Glasgow file as there were only two distinct values. The legend and details are the column that contains the “True” or “False.” Values are the count of this field.</li>
<li>Go to the filter pane and add a filter for the column ‘Postcode Length.’ Tick ‘5’ and ‘6.’ This will only bring back the score for the full postcodes given. The blank postcodes have already been scored and the incomplete postcodes are scored separately in the next tab.</li>
</ol>
</div>
<div id="score-2---partial-postcode-given-1" class="section level3" number="5.7.3">
<h3>
<span class="header-section-number">5.7.3</span> Score 2 - Partial postcode given<a class="anchor" aria-label="anchor" href="#score-2---partial-postcode-given-1"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Go to the reports tab and into the ‘Score 2’ sheet.</li>
<li>Click onto a visualisation to insert. A pie chart was used for the Glasgow file. The legend and details field is the Postcode Length Column and Values are the Count of the postcode length field.</li>
<li>Go to the filter pane and add a filter for the column ‘Postcode Length.’ Untick ‘0,’ ‘5’ and ‘6.’ This will bring back the score for the postcodes that were incomplete and were not blank. Ful and blank postcodes have been scored elsewhere.</li>
</ol>
</div>
<div id="score-3---postcode-matches-paf-but-given-in-the-incorrect-field-1" class="section level3" number="5.7.4">
<h3>
<span class="header-section-number">5.7.4</span> Score 3 - Postcode matches PAF but given in the incorrect field<a class="anchor" aria-label="anchor" href="#score-3---postcode-matches-paf-but-given-in-the-incorrect-field-1"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Go to the Query Editor (click transform data) and load the Companies House data file.</li>
<li>Insert a conditional column.</li>
<li>Insert a condition that RegAddress.AddressLine1 contains ‘G1,’’G2’,’G3’,’G4’,’G5’,’G6’,’G7’</li>
<li>This formula will bring back the 0 if there isn’t a postcode in the address line 1 field, or ‘Postcode in address line 1’ if the postcode is in this column.</li>
<li>Repeat steps 2-4 for RegAddress.AddressLine2 and RegAddress.PostTown</li>
<li>Filter the ‘PAF Match’ column to ’False’ – the ones which show ‘True’ are scored otherwise.</li>
<li>Check the remaining rows for any data that doesn’t match the conditions.</li>
<li>Close and apply the query.</li>
<li>Go to the reports tab and into the ‘Score 3’ sheet.</li>
<li>Insert a visualisation – a clustered bar chart was used for this data.</li>
<li>The Axis values were the PAF Match column and values were a count of the column with the postcodes contained in address line 1.</li>
<li>Go to the filter pane and add a filter for the column containing the count of the postcodes in line 1, and untick the ‘0’ option. The visual will now only be looking at postcodes contained in address line 1.</li>
<li>Repeat steps 11&amp;12 for the postcodes in address line 2 and post town.</li>
<li>The bar charts now show how many postcodes were in the address lines.</li>
<li>A second filter can be added on the ‘PAF Match’ column with only ‘False’ ticked to show the postcode values in the postcode column that did not match the PAF. For this report, both ‘True’ and ’False´ values were kept in the visual.</li>
<li>Only the values where a full postcode in an address field and ‘False’ in the PAF match field were counted.<br>
In this data set, there were no full, correct postcodes given in the address fields.
<strong>NOTE</strong> If a full postcode matching the PAF file was entered into the address line 1 and 2 or post town, these would need filtering out of the Score 1 postcodes, otherwise some postcodes would be scored both 1 and 4. In this data set, none of the postcodes given in the address fields matched the PAF, so this step was left out.</li>
</ol>
</div>
<div id="score-4---full-correct-postcode-given-address-doesnt-match-paf-1" class="section level3" number="5.7.5">
<h3>
<span class="header-section-number">5.7.5</span> Score 4 - Full correct postcode given, address doesn’t match PAF<a class="anchor" aria-label="anchor" href="#score-4---full-correct-postcode-given-address-doesnt-match-paf-1"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Go to the Query Editor and open the PAF data</li>
<li>Highlight sub_building_name, building_number, thoroughfare.name and thoroughfare.descriptor – NA on Glasgow data columns in that order and merge. The delimiter is a space.</li>
<li>Once the column has been created, right click the column, click Transform then Trim. This removes spaces from the beginning and end of the text.</li>
<li>Close &amp; Apply the Query.</li>
<li>Open data view and open the Companies House data file</li>
<li>Add a new column and type in the formula Address Match = CONTAINS(‘B-2022-03,’‘B-2022-03’[Merged],‘BasicCompanyDataAsOneFile-2022-03-01’[Address Line 1])</li>
<li>The companies where address line 1 matches the PAF will come back as ‘True’ and the ones that do not match will be ‘False’</li>
<li>Go to the ‘Score3&amp;5’ report tab and click onto a visualisation to insert.</li>
<li>The Details is the column that contains the ‘True’ or ‘False’ that was just created and the values are a count of this column.<br>
</li>
<li>Go to the Filter column and add a Filter for the ‘PAF Match’ column and untick ‘False.’</li>
<li>The values in this report that are ‘True’ score 5, and those that are ‘False’ score 3.</li>
</ol>
</div>
<div id="score-5---full-correct-postcode-given-address-partially-matches-paf-1" class="section level3" number="5.7.6">
<h3>
<span class="header-section-number">5.7.6</span> Score 5 - Full correct postcode given, address partially matches PAF<a class="anchor" aria-label="anchor" href="#score-5---full-correct-postcode-given-address-partially-matches-paf-1"><i class="fas fa-link"></i></a>
</h3>
<p>See below section for partial matching methods tested. The method for Score 5 is yet to be completed but Python coding should be attempted next in order to score the data. This can be integrated into Power BI or completed before importing the data to Power BI.</p>
<p><strong>Partial matching methods tested</strong></p>
<p><em>Test 1 - Fuzzy merges on Power BI</em></p>
<ol style="list-style-type: decimal">
<li>Go to Transform data and open the PAF</li>
<li>Highlight the columns ‘sub_building_name,’ ‘building_number,’ ‘thoroughfare.name,’ ‘thoroughfare.descriptor.’ Right click and merge the columns.</li>
<li>On the Home tab, click Merge Queries &gt; Merge Queries as New.</li>
<li>Select the PAF as the first able and highlight the Merged Addresses column.</li>
<li>For the second table, select the Glasgow file and highlight the RegAddress.AddressLine1</li>
<li>The join type is Left Outer</li>
<li>The threshold was tested at 0.8, then at 0.7</li>
</ol>
<p>The below snip of the merged table shows an example of an address in the left column that was matched to the addresses using the fuzzy matching in Power BI. Some of the building numbers in those that were matched were incorrect with only one character difference. If the similarity threshold was increased, it would mean the partial match would not pick up on any mis-typed addresses.</p>
<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="images/snip.png" alt="Merged Table Example" width="50%"><p class="caption">
Figure 5.1: Merged Table Example
</p>
</div>
<p><em>Test 2 – Fuzzy merges on Power BI</em></p>
<p>A second test on the partial matching addresses was done with the numbers removed from the PAF merged addresses column.</p>
<p>The same method was used, but by merging the columns in the PAF, not including the building number. The similarity threshold and join type were also kept the same (0.7, Left Outer Join). The test was completed on addresses in the Glasgow file RegAddress.AddressLine1 and RegAddress.AddressLine2.</p>
<p>The tables below show the matches from the Glasgow file and PAF with only a few characters difference that were incorrect but this method was showing as a match. As with Test 1, increasing the threshold would reduce the likelihood of matching those with a mistyped address that is still partially correct.</p>
<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="images/snip2.png" alt="Merged Table Example - RegAddress.AddressLine1" width="50%"><p class="caption">
Figure 5.2: Merged Table Example - RegAddress.AddressLine1
</p>
</div>
<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="images/snip3.png" alt="Merged Table Example- RegAddress.AddressLine2" width="50%"><p class="caption">
Figure 5.3: Merged Table Example- RegAddress.AddressLine2
</p>
</div>
<p><em>Test 3 – Using a range of similarity thresholds on Power BI</em></p>
<p>After the above method had been tried, using ranges as below for matching the addresses was considered:</p>
<p>0.0 – 0.3 – No match
0.4 – 0.6 – Partial match
0.7 – 1 – Full match</p>
<p>Power BI does not allow a range of numbers to be used within the similarity threshold so this method was not used, but documented for awareness.</p>
<p><em>Test 4 – List.Containsany function on Power BI</em></p>
<ol style="list-style-type: decimal">
<li>Create new query</li>
<li>Type = #shared in the formula bar to show a list of all available queries</li>
<li>find list.containsany</li>
<li>For the first table use CH Glasgow address line 1 and for the second, select the merged addresses column from the PAF.</li>
<li>This will bring back any values that are matching.</li>
<li>For this, there were no matching addresses between the files.</li>
</ol>
<p><em>Test 5 – Python coding</em></p>
<p>For integrating Python into Power BI:</p>
<ol style="list-style-type: decimal">
<li>Open transformation table</li>
<li>Click run Python script</li>
<li>Enter script into jupyter notebook</li>
<li>Copy and paste in box in power BI. This should run the script and the output can be used in BI.</li>
</ol>
<p>Proposed method for using Python for partial matching is outlined in the link below.</p>
<p>thefuzz/README.rst at master · seatgeek/thefuzz · GitHub</p>
<p>The columns to work with are Address line 1 &amp; 2 in the CH data and the merged column in PAF.</p>
<p><strong>Comments &amp; Update - 31/03/2022</strong></p>
<ol style="list-style-type: decimal">
<li>The ‘fuzzy matching’ was attempted for Score 5, however, addresses with one digit difference in the building number were brought back as a matched address from the PAF File.</li>
</ol>
<div class="figure" style="text-align: left">
<span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="images/snip4.png" alt="Fuzzy Matching for Score 5" width="50%"><p class="caption">
Figure 5.4: Fuzzy Matching for Score 5
</p>
</div>
<p>The Companies House Address Line 1 column was then split by number, building name and street name and repeated on address line 2.</p>
<p><strong>Comments &amp; Update – April 2022</strong></p>
<ol style="list-style-type: decimal">
<li>Fuzzy matching on Power BI doesn’t work for what we need it to. It was decided we would use Python integrated into Power BI to clean the data and Python coding may work for the partial matching (score 5), and Power BI should be used for the dashboards/visualisations.</li>
</ol>
</div>
<div id="score-6---address-and-postcode-details-match-paf-1" class="section level3" number="5.7.7">
<h3>
<span class="header-section-number">5.7.7</span> Score 6 - Address and postcode details match PAF<a class="anchor" aria-label="anchor" href="#score-6---address-and-postcode-details-match-paf-1"><i class="fas fa-link"></i></a>
</h3>
<p>These were scored while scoring postcodes with a ‘4.’ Any that did not score 4, were given the score of 5. These were The same conditions in the address line details, but with the PAF Match column filtered to those that were ‘True’ and matched the postcode field in Companies House Data.</p>
</div>
</div>
<div id="power-bi-report-link-1" class="section level2" number="5.8">
<h2>
<span class="header-section-number">5.8</span> Power BI Report Link<a class="anchor" aria-label="anchor" href="#power-bi-report-link-1"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="power-bi-dashboard-link-1" class="section level2" number="5.9">
<h2>
<span class="header-section-number">5.9</span> Power BI Dashboard Link<a class="anchor" aria-label="anchor" href="#power-bi-dashboard-link-1"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="recommendations-for-next-steps-june-2022" class="section level2" number="5.10">
<h2>
<span class="header-section-number">5.10</span> Recommendations for next steps – June 2022<a class="anchor" aria-label="anchor" href="#recommendations-for-next-steps-june-2022"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Define what a ‘good address’ would look like in Companies House data. One of the issues with current data is that some address details are not in the appropriate field, such as the town being input into ‘Address Line 2’ column instead of the Post Town column. Examples of an acceptable address should be documented to compare with those that have been submitted by companies.</li>
<li>If the postcode field in CH data is blank, consider augmenting data by adding a new column to lookup the company address to bring back a postcode that exists in the PAF. Currently CH cannot correct any submitted data such as postcodes but a reference column for a matched address could be added, as outlined in Corporate Transparency and Register Reform White Paper (publishing.service.gov.uk), “If an individual fails to verify, the public register will be annotated to show this. This will enable anyone viewing the register to make their own assessment of the integrity and risk profile of those they are researching.”</li>
<li>Conduct further analysis on the correlation between a Company not supplying a postcode, or not supplying a correct address (one that doesn’t match the PAF) and filing accounts and confirmation statements on time. Preliminary analysis has been completed on this and in the future, the quality of addresses submitted could be used as an indicator for companies that are fraudulent, or would not file accounts and confirmation statements on time. The analysis already completed can be found in the following BI Dashboard: <a href="https://app.powerbi.com/groups/me/dashboards/2921b718-7552-40f2-b759-6ae77120bad5?ctid=e6acfe5e-7f2a-455a-9d85-ecf93371f601&amp;pbi_source=linkShare" class="uri">https://app.powerbi.com/groups/me/dashboards/2921b718-7552-40f2-b759-6ae77120bad5?ctid=e6acfe5e-7f2a-455a-9d85-ecf93371f601&amp;pbi_source=linkShare</a>
</li>
<li>Alter the method used to clean Companies House data, such as removing unnecessary columns and whitespace in the postcode fields. Instead of using Power BI, Python could be a better option. This will also save time when using other data files that will need to be cleaned in the same way because the Python code can be copied and reused for each file.</li>
<li>Use Python Fuzzy String matching for the partial matching scores. This can be done through Power BI or before import and the code used for other CH data files for Score 5.</li>
<li>Continue to find alternative software for analysis, such as AWS, so files don’t need to be saved and imported into software, or split because they are too large to analyse as a full set with our current software. Currently, the PAF is split into sections (Birmingham and Glasgow in this example), so the Companies House data requires filtering to find addresses in those cities, however, not all postcodes with the filters applied are in the correct cities, as it is impossible to capture them all, particularly when some data is missing or in the wrong format. Addresses are also input into several different fields, or customers do not state the city, but smaller towns within the city as the main post town. This makes it unfeasible to filter the CH accurately. This is a temporary issue until we can use software to analyse the full PAF against Companies House data.</li>
<li>Consider collaborative work with engineers or data scientists within CH who may already have completed similar analysis</li>
</ol>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="birmingham-address-matching.html"><span class="header-section-number">4</span> Birmingham Address Matching</a></div>
<div class="next"><a href="application-programming-interface-api.html"><span class="header-section-number">6</span> Application Programming Interface (API)</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#glasgow-address-matching"><span class="header-section-number">5</span> Glasgow Address Matching</a></li>
<li><a class="nav-link" href="#introduction-and-purpose-1"><span class="header-section-number">5.1</span> Introduction and Purpose</a></li>
<li><a class="nav-link" href="#scores-used-1"><span class="header-section-number">5.2</span> Scores used</a></li>
<li>
<a class="nav-link" href="#data-1"><span class="header-section-number">5.3</span> Data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#companies-house-data-1"><span class="header-section-number">5.3.1</span> Companies House Data</a></li>
<li><a class="nav-link" href="#postcode-address-file-1"><span class="header-section-number">5.3.2</span> Postcode Address File</a></li>
</ul>
</li>
<li><a class="nav-link" href="#software-1"><span class="header-section-number">5.4</span> Software</a></li>
<li><a class="nav-link" href="#caveats-and-limitations-1"><span class="header-section-number">5.5</span> Caveats and Limitations</a></li>
<li>
<a class="nav-link" href="#method-1"><span class="header-section-number">5.6</span> Method</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#cleaning-the-data-1"><span class="header-section-number">5.6.1</span> Cleaning the data</a></li>
<li><a class="nav-link" href="#separating-the-glasgow-data"><span class="header-section-number">5.6.2</span> Separating the Glasgow data</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#scoring-the-data-1"><span class="header-section-number">5.7</span> Scoring the data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#score-0---no-postcode-given-1"><span class="header-section-number">5.7.1</span> Score 0 - No Postcode Given</a></li>
<li><a class="nav-link" href="#score-1---postcode-given-but-doesnt-exist-in-paf-1"><span class="header-section-number">5.7.2</span> Score 1 - Postcode given but doesn’t exist in PAF</a></li>
<li><a class="nav-link" href="#score-2---partial-postcode-given-1"><span class="header-section-number">5.7.3</span> Score 2 - Partial postcode given</a></li>
<li><a class="nav-link" href="#score-3---postcode-matches-paf-but-given-in-the-incorrect-field-1"><span class="header-section-number">5.7.4</span> Score 3 - Postcode matches PAF but given in the incorrect field</a></li>
<li><a class="nav-link" href="#score-4---full-correct-postcode-given-address-doesnt-match-paf-1"><span class="header-section-number">5.7.5</span> Score 4 - Full correct postcode given, address doesn’t match PAF</a></li>
<li><a class="nav-link" href="#score-5---full-correct-postcode-given-address-partially-matches-paf-1"><span class="header-section-number">5.7.6</span> Score 5 - Full correct postcode given, address partially matches PAF</a></li>
<li><a class="nav-link" href="#score-6---address-and-postcode-details-match-paf-1"><span class="header-section-number">5.7.7</span> Score 6 - Address and postcode details match PAF</a></li>
</ul>
</li>
<li><a class="nav-link" href="#power-bi-report-link-1"><span class="header-section-number">5.8</span> Power BI Report Link</a></li>
<li><a class="nav-link" href="#power-bi-dashboard-link-1"><span class="header-section-number">5.9</span> Power BI Dashboard Link</a></li>
<li><a class="nav-link" href="#recommendations-for-next-steps-june-2022"><span class="header-section-number">5.10</span> Recommendations for next steps – June 2022</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/companieshouse/DARr/blob/master/06-GLA_address_match.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/companieshouse/DARr/edit/master/06-GLA_address_match.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Companies House Data Quality</strong>" was written by Rob Eva and Lauren Calow. It was last built on 2022-07-27.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
